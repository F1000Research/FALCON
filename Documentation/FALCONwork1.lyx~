#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
An adaptive ensemble algorithm for significance testing: software for comparing
 nestedness as a case study
\end_layout

\begin_layout Author
Stephen J.
 Beckett*, Hywel T.
 P.
 Williams
\end_layout

\begin_layout Address
\align center
College of Life and Environmental Sciences, University of Exeter, Exeter,
 UK
\end_layout

\begin_layout Standard
\align center
*author for correspondence: S.J.Beckett@exeter.ac.uk
\end_layout

\begin_layout Abstract
Once a result has been found it is often a key question to ask about the
 significance of that result; how likely was that result given some rules
 that govern the system (null model).
 FALCON 
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Significance testing is one of the most often used (though not always well)
 statistical frameworks.
 Regardless where you look in the scientific literature there is a healthy
 appreciation of results presented with their corresponding p-values.
 P-values or probability values(?) are found by comparing the result the
 researcher is interested in with a number of other experiments.
 In practical (lab/field) contexts the number of experiments that can be
 performed is often limited in some way e.g.
 by time, money, controlling experimental conditions, ethical considerations.
 Computational scientists are often in a better position to perform a large
 number of numerical experiments to test their results (though more complex
 models can take considerable amounts of time).
 In these cases researchers choose to perform a large number of experiments,
 called an ensemble, in order to evaluate the significance of their result
 - the number performed varies on the complexity of the model and considerations
 of the researcher and can be over 10,000.() How many null models should
 you test? It depends what you want to know about the underlying space you
 are sampling from, so do you have to perform 10,000 ensembles - probably
 not.
\end_layout

\begin_layout Standard
I introduce a framework of converging on the sample space which is coded
 up in the context of looking at measures of nestedness in a software package
 called FALCON (Framework for Adaptive ensembLes for the Comparison of Nestednes
s).
 This paper serves as a desciption of the approach and methods used in the
 FALCON software, whilst the results of the follow up work in comparing
 some of the plethora of nestedness measures is described in a follow up
 paper (Beckett and Williams, 2013).
\end_layout

\begin_layout Standard
NEED TO SAY WHERE FALCON IS AVAILABLE+ again at beginning of methods
\end_layout

\begin_layout Standard
\begin_inset Quotes eld
\end_inset

How significant are your results?
\begin_inset Quotes erd
\end_inset

 is an often asked question in many branches of research, and a common .
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Type
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary/Quantitative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Reference
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NODF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Measure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "almeida2008consistent"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
WNODF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Measure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Quantitative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "almeida2011straightforward"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\tau$
\end_inset

-Temperature
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Measure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "corso2012nestedness"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Spectral Radius
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Measure
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Both
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "staniczenko2013ghost"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E-E
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Null
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F-F
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Null
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "miklos2004randomization"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RF-RF
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Null
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
This Paper
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Shuffle
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Null
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Quantitative
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset citation
LatexCommand cite
key "staniczenko2013ghost"

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Summary of nestedness measures and nulls included in FALCON
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Ensemble Methods
\end_layout

\begin_layout Standard

\color red
can fill most of this in using SI from original write up!! :D
\end_layout

\begin_layout Standard
Both 
\series bold

\begin_inset Formula $\tau$
\end_inset


\series default
-Temperature and the spectral radius nestedness measures are found by comparing
 a measure from the network we want to measure against that found from a
 large ensemble of null models.
 This raises the question of how large should this ensemble should actually
 be and how do we know we have a good ensemble size? Intuitively, we can
 imagine that larger networks would require larger ensemble sizes due to
 the extra permutations that can be performed on the network elements.
 Choosing a large fixed number is not enough - indeed for small networks
 it is computationally inefficient! Similarly, for large networks, we don't
 really want to perform an extravagantly large number of null models, that
 may be more than sufficient.
 We get around these issues by using an adaptive convergent solution method.
 For each test we perform an (even) minimum number of null models, storing
 half the solutions in one group, which we can call BLIND and the other
 half in any group, which we can call TEST.
 We then compare the mean test-statistic of BLIND to the mean test-statistic
 in TEST.
 When the absolute difference between these mean test-statistics is below
 some threshold 
\begin_inset Formula $\zeta$
\end_inset

, such that 
\begin_inset Formula $\zeta<<1$
\end_inset

, we assume that both BLIND and TEST have sufficiently converged towards
 the global mean test-statistic of all possible null values and as such
 that BLIND and TEST are representative samples of the population of all
 possible null values.
 If the threshold is not satisfied the operation is repeated, adding another
 set of null model tests to both BLIND and TEST, until the threshold is
 reached or the total number of null models tested is very large.
 Then we combine the solutions into an average from the two groups.
 At it's best this method is far more computationally efficient than just
 using a large number; and at it's worse is exactly the same as just using
 a large number in the first place.
 Note that to be sure the solution used has been converged on properly that
 the initial, minimum number of null models performed should be of a reasonable
 size; or a larger number of groups could be used to test the threshold
 against.
 In this paper we set the minimum number of null models 
\color black
to 100, the maximum number of null models to 5000 and the threshold, 
\begin_inset Formula $\zeta$
\end_inset

 to 0.001.
 
\end_layout

\begin_layout Subsection
Fixed Ensemble
\end_layout

\begin_layout Subsection
Adaptive Ensemble
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Cartoon depiction of converging on the sample space.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section

\series bold
Nestedness Measures
\end_layout

\begin_layout Standard
There exists a plethora of different methods to measure the amount of order/diso
rder in a matrix as first envisaged by 
\color black

\begin_inset CommandInset citation
LatexCommand citealp
key "atmar1993measure"

\end_inset

.

\color inherit
 Their original concept was based on extending the ideas of Island Biogeography
 Theory 
\begin_inset CommandInset citation
LatexCommand cite
key "macarthur1967theory"

\end_inset

, such that as well as expecting that smaller islands that are further from
 mainland have lower species diversity and abundance due to immigration/emmigrat
ion processes that these islands contain a species composition that is a
 subset of the species compositions of islands closer to the mainland.
 In a perfect setting this would mean that the mainland would contain all
 the species found on any of the islands, such that the perfectly nested
 matrix contains an upper triangular pattern.
 This use of this site-species bipartite network concept has been extended
 by others to cover many species-species bipartite networks, which are undergoin
g mutualistic or antagonistic interactions 
\begin_inset CommandInset citation
LatexCommand cite
key "fortuna2010nestedness,joppa2010nestedness"

\end_inset

 , but should be regarded as a network structure in it's own right, applicable
 to any type of bipartite network.
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Subsection

\series bold
NODF
\end_layout

\begin_layout Standard
The nestedness measure based on overlap and decreasing fill(NODF) was first
 described by 
\begin_inset CommandInset citation
LatexCommand citealp
key "almeida2008consistent"

\end_inset

 and has since become the most popular method for describing the nestedness
 of a matrix.
 This is in part due to it's ease of use, as it is deterministic and does
 not need to statistically evaluated against an ensemble of null models
 and also to the transparency of it's methods as it's calculation is explicitly
 shown in the paper and is not subject to difficult calculations or algorithms.
 As we do not (and in general it isn't) know of any ecological gradient
 across our matrix, we use the form of NODF known as 
\begin_inset Formula $NODF_{MAX}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "podani2012comparative"

\end_inset

.
 We first find the degree of each row and column by finding the number of
 elements in each row/column with a value greater than zero.
 To achieve 
\begin_inset Formula $NODF_{MAX}$
\end_inset

 the matrix must be sorted by the degree of the rows and the columns such
 that the rows with highest degree are at the top of the matrix and the
 rows with lowest degree are at the bottom; and repeat with the columns.
 Then 
\begin_inset Formula $NODF_{COLUMNS}$
\end_inset

 can be found by pairwise evaluating columns.
 This works by taking the first column(highest degree) and comparing it
 to the second column.
 If both columns have same degree there cannot be overlap, so a zero score
 is assigned, else the score is the percentage of elements in the second
 column which also appear in the first column i.e.
 how much of a subset the second column is of the first.
 This process is repeated to compare the first column against all the other
 columns; then the second column is compared against the remaining columns,
 of which it should be a superset, and so on.
 The sum of all these scores is the column score, 
\begin_inset Formula $N_{col}$
\end_inset

.
 
\begin_inset Formula $NODF_{COLUMNS}$
\end_inset

 is found by dividing 
\begin_inset Formula $N_{col}$
\end_inset

 by the number of comparisons, the number of columns (
\begin_inset Formula $c$
\end_inset

) multiplied by the number of columns minus one all divided by two 
\begin_inset Formula $\left(\frac{c(c-1)}{2}\right)$
\end_inset

.
 
\begin_inset Formula $NODF_{ROWS}$
\end_inset

 can be found in a similar manner.
 Putting these two measures together 
\begin_inset Formula $NODF_{MAX}$
\end_inset

 can be found as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
NODF_{MAX}=\frac{N_{col}+N_{row}}{\frac{(c(c-1)}{2}+\frac{(r(r-1))}{2}}=\frac{2(N_{col}+N_{row})}{c(c-1)+r(r-1)}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Values for each of the NODF indexes is measured between 0, low nestedness
 and 100, perfect nestedness.
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Subsection

\series bold
WNODF
\end_layout

\begin_layout Standard
The weighted NODF measure, WNODF
\begin_inset CommandInset citation
LatexCommand citep
key "almeida2011straightforward"

\end_inset

 is found using a similar algorithm for NODF, but is designed for use on
 quantitative rather than binary networks.
 In addition to asking which pairs of rows/columns are subsets of one another,
 by filled positions, for a row/column to be a weighted subset the preceding
 row/column must have greater values.
 As such, WNODF is essentially a stricter version of NODF and the highest
 score that could be achieved in WNODF is equal to that made under binary
 constraints in NODF.
 WNODF's assumptions consist in that a more nested matrix is one where the
 generalists have higher abundance than the specialists.
 Whilst this makes sense for species-site relationships in island biogeography
 theory, it makes less sense for antagonistic species-species relationships.
 Indeed it may well be expected that a tradeoff between generalism and specialis
m exists such that each specialist interaction should have a greater interaction
 than that of more generalist compatriots.
 Hence, we also look at WNODF in reverse such that the gradient is evaluated
 such that contributions to the WNODF-Reverse score only count if specialists
 have stronger interactions than that of generalists.
 We also investigated a mixture of WNODF row with WNODF-Reverse column scores
 and vice-versa.
 For example it may be expected that specialist phage (on generalist hosts)
 have high adsorption rates, whilst specialist hosts (with generalist phage)
 have low adsorption rates(WNODF rows, WNODF-Reverse columns).
 Both these mixed scores were higher than WNODF by the end of the simulation,
 but not as strong as that given by WNODF-Reverse.
 Indeed if we denote WNODF-Equal to only score when subsets have the same
 interaction strength, NODF can be rewritten in terms of WNODF scores as:
\begin_inset Formula 
\begin{equation}
NODF=WNODF+WNODF^{REVERSE}+WNODF^{EQUAL}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Subsection

\series bold
\begin_inset Formula $\mathbf{\tau}$
\end_inset

-Temperature
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $\mathbf{\tau}$
\end_inset

-Temperature
\begin_inset CommandInset citation
LatexCommand citep
key "corso2012nestedness"

\end_inset

 measure is an example of a nestedness measure based on relative distances
 in a matrix of present and absent elements.
 Unlike other distance based measures such as Atmar and Patterson's NTC,
 
\begin_inset CommandInset citation
LatexCommand citep
key "atmar1993measure"

\end_inset

 and it's better described successors, BINMATNEST
\begin_inset CommandInset citation
LatexCommand citep
key "rodriguez2006new"

\end_inset

 and AININHAD
\color black
O
\begin_inset CommandInset citation
LatexCommand citep
key "guimaraes2006improvingAninhado"

\end_inset

, 
\color inherit
the 
\begin_inset Formula $\mathbf{\tau}$
\end_inset

-Temperature is clearly mathematically defined and does not rely on Genetic
 Algorithms to sort the data.
 It also has the property that it can be evaluated just by rows, or columns
 which makes it appealing and it apparently behaves well against nestedness
 found by NODF
\begin_inset CommandInset citation
LatexCommand citep
key "corso2012nestedness"

\end_inset

.
 The 
\begin_inset Formula $\mathbf{\tau}$
\end_inset

-Temperature is found by 
\color black
shuffling the network matrix by the degree of rows and columns as described
 for finding NODF
\begin_inset Formula $_{MAX}$
\end_inset

 and
\color inherit
 then measuring the Manhattan distance 
\begin_inset Formula $D$
\end_inset

 of the network matrix.
 This is the sum of the row and column indexes of the matrix elements that
 are filled.
 Once 
\begin_inset Formula $D$
\end_inset

 is found, a null model is chosen (
\color black
cf.
 
\begin_inset CommandInset ref
LatexCommand formatted
reference "sec:Null-Models"

\end_inset


\color inherit
) and an ensemble of matrices with similar properties to the studied matrix
 network are created and measured in a similar way.
 Each of these measurements is denoted 
\begin_inset Formula $D_{rand}$
\end_inset

.
 By finding the mean average 
\begin_inset Formula $D_{rand}$
\end_inset

, denoted 
\begin_inset Formula $<D_{rand}>$
\end_inset

 from a large ensemble of null models 
\begin_inset Formula $\mathbf{\tau}$
\end_inset

-Temperature can be calculated as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\tau=\frac{D}{<D_{rand}>}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
That is the nestedness of the network for which 
\begin_inset Formula $D$
\end_inset

 was calculated against the expected nestedness of similar networks.
 As Manhattan distance is lower in more nested networks, then 
\begin_inset Formula $\tau>1$
\end_inset

 implies 
\begin_inset Formula $D$
\end_inset

 is greater than 
\begin_inset Formula $<D_{rand}>$
\end_inset

 and so the network is less nested than expected for a network with the
 properties defined in the null model.
 
\begin_inset Formula $\mathbf{\tau}$
\end_inset

 can be described as a test statistic of the 
\begin_inset Formula $\mathbf{\tau}$
\end_inset

-Temperature method.
 We note it is also possible to calculate a p-value for nestedness from
 the 
\series bold

\begin_inset Formula $\tau$
\end_inset


\series default
-Temperature by counting how many of the null models that make up the ensemble
 have a Manhattan distance less than that in our original network; i.e.
 are more nested than the network being studied, and divide this by the
 number of networks making up the ensemble.
 Then a low p-value(less than 0.05) corresponds to the matrix network being
 significantly nested.
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Subsection

\series bold
Spectral Radius
\end_layout

\begin_layout Standard

\color black
The spectral radius (
\begin_inset Formula $SR$
\end_inset

) is defined as the absolute value of the maximum real eigenvalue for a
 matrix and provides a link between the concept of nestedness and linear
 algebra and dynamical systems theory.
 Why such a link exists is hard to say, but it shows that 
\begin_inset CommandInset citation
LatexCommand citealp
key "atmar1993measure"

\end_inset

 were closer to the truth than they could have thought in defining nestedness
 to be a highly ordered state from ideas about entropy.
 
\begin_inset CommandInset citation
LatexCommand citealp
key "staniczenko2013ghost"

\end_inset

 show in their paper that highly nested matrix structures
\begin_inset CommandInset citation
LatexCommand citep
key "atmar1993measure,almeida2008consistent"

\end_inset

 tend to have a greater 
\begin_inset Formula $SR$
\end_inset

 than that of other matrix permutations in binary matrices and similarly
 that less nested structures have small 
\begin_inset Formula $SR$
\end_inset

.
 They measure the significance of the nestedness of a particular matrix
 by evaluating the p-value, counting up the number of ensemble matrices
 built from null models that have a greater 
\begin_inset Formula $SR$
\end_inset

 than the original network.
 They also go on to show their approach is applicable to networks containing
 quantitative measures and that the SR approach measures quantitative nestedness
 in a similar way to WNODF, such that more nested matrices are those where
 the generalists have greater interaction strengths than specialists.
\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Standard
We can also calculate a test-statistic for 
\begin_inset Formula $SR$
\end_inset

, as done for the 
\series bold

\begin_inset Formula $\tau$
\end_inset


\series default
-Temperature, which we shall call the 
\begin_inset Formula $SRT$
\end_inset

.
 As nestedness is maximised with a minimised distance in 
\begin_inset Formula $\tau$
\end_inset

-Temperature, but maximised with a larger 
\begin_inset Formula $SR$
\end_inset

 we use the inverse of the normalisation procedure as for 
\series bold

\begin_inset Formula $\tau$
\end_inset


\series default
-Temperature to allow for comparisons.
 The 
\begin_inset Formula $SRT$
\end_inset

 can be calculated as the ratio between the spectral radius of our original
 network, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $SR(Network)$
\end_inset

,
\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 and the mean 
\begin_inset Formula $SR$
\end_inset

 from a large ensemble of null models
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 
\begin_inset Formula $<SR_{rand}>$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
 :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
SRT=\frac{<SR_{rand}>}{SR(Network)}
\end{equation}

\end_inset


\end_layout

\begin_layout Section

\series bold
Null Models
\begin_inset CommandInset label
LatexCommand label
name "sec:Null-Models"

\end_inset


\end_layout

\begin_layout Standard
We need to use appropriate null models to understand how the network we
 are interested in studying compares to other networks with similar properties.
 To quote 
\begin_inset CommandInset citation
LatexCommand citep
key "joppa2010nestedness"

\end_inset

, 
\begin_inset Quotes eld
\end_inset

the key question in claiming that observed patterns are nested is: 'compared
 to what?'
\begin_inset Quotes erd
\end_inset

 The big problem with choosing an effective null model is to find one which
 minimises type I (false acceptance of null hypothesis) and type II (false
 rejection of the null hypothesis) errors 
\begin_inset CommandInset citation
LatexCommand citep
key "joppa2010nestedness"

\end_inset

.
 For a binary network 
\begin_inset CommandInset citation
LatexCommand citealp
key "staniczenko2013ghost"

\end_inset

 suggest 3 different tests, which use 3 different null models.
 All of these binary null models have some common constraints; each random
 null model network conserves the same dimensions as in the tested network
 (same number of hosts and same number of phage) and also the same number
 of interactions, also known as the matrix fill.
 The three tests are (1) a matrix described as above.
 (2) the same as 1, but with a constraint that the network is connected(such
 that there is a path from one node to every other node in the entire network).
 (3) the same as 2, but also that the degrees of columns and the degrees
 of rows are kept the same as in the original network.
 The degree of a row/column is the number of elements which have a value
 in that particular row/column.

\color black
 Null models of type (3) are created using the Miklos-Podani trial row swap
 algorithm
\begin_inset CommandInset citation
LatexCommand citep
key "miklos2004randomization"

\end_inset

, which swaps matrix elements such that row and column degrees are conserved.
 It does this by picking two rows and two columns and combining the four
 intersections into a submatrix.
 If this submatrix contains ones and zeros in opposite corners, then they
 can be swapped whilst conserving row and column degrees as in Fig 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{MPtrialswap}
\end_layout

\end_inset

.
 Note that the Manhattan distance is invariant to these swaps, so is not
 an appropriate null model for 
\begin_inset Formula $\tau$
\end_inset

-Temperature.
 We do however include it for completeness.
\end_layout

\begin_layout Standard
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /home/sjb250/Desktop/Phage-host infected networks paper/suppinfofigs/miklospodaniswaptrialalg.png
	width 100text%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout
Trial swap algorithm.
 Two rows (
\begin_inset Formula $r{}_{a}$
\end_inset

 and 
\begin_inset Formula $r_{b}$
\end_inset

) and two columns (
\begin_inset Formula $c_{x}$
\end_inset

 and 
\begin_inset Formula $c_{y}$
\end_inset

) are chosen and their intersecting elements are formed into a submatrix.
 If the submatrix contains an equal number of ones and zeros and these elements
 are in opposite corners a swap can occur (such that the ones are in the
 corners that the zeros perviously occupied and vice-versa).
 Note the Manhatton distance is invariant to such a swap 
\begin_inset Formula $D=(r_{a}+c_{x})+(r_{b}+c_{y})=(r_{a}+c_{y})+(r_{b}+c_{x})$
\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
label{MPtrialswap}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Standard

\color black
In general, we do not expect our networks to be connected graphs - we expect
 them to display modular structures, such that there are connected subgraphs
 that do not interact with one another.
 This excludes null model (2) and we modify (3) such that a connected graph
 is not required.
 Of the null models we choose to test, (3) is the better null model as it
 better reflects the relationships formed between the number of bacterial
 hosts a phage can infect (and vice versa), which have dynamically coevolved
 in nature
\begin_inset CommandInset citation
LatexCommand citep
key "joppa2010nestedness"

\end_inset

.
 However, there exist cases when using (3) such that the only null model
 that can be created is equivalent to the original matrix.
 We therefore also chose to look at null model (1).
\begin_inset Note Comment
status open

\begin_layout Plain Layout

\color black
We also considered a new case of null model - which closely represents the
 degree distribution of the original matrix.
 This model uses the same degree distribution -1, (except for cases where
 degree=1, then randomly assigns the remaining elements, such that the matrix
 fill is conserved.
 Do we???
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset Formula $\,$
\end_inset


\end_layout

\begin_layout Standard
For quantitative networks, 
\begin_inset CommandInset citation
LatexCommand citealp
key "staniczenko2013ghost"

\end_inset

 suggest using a null model which has the same dimensions as the original
 matrix, where the zero elements are kept in the same position as in the
 original network and the positions of the filled elements are shuffled
 around the matrix.
 
\end_layout

\begin_layout Section
Using FALCON
\end_layout

\begin_layout Standard
Currently FALCON only exists for use in MATLAB software, though there are
 plans to make it accessible in R.
 See the document 
\series bold
INTRUCTIONS_FOR_FALCON.pdf
\series default
 for details on how to run FALCON.
\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Section
Discussion
\end_layout

\begin_layout Standard
Not the only way of creating a robust statistical test.
 For example could examine how the derivatives of the mean and s.d.
 change as more samples are taken and use this as a way of saying how good
 the sampling of the underlying distribution is.
 Would like to see more robust approaches to statistical significance testing.
\end_layout

\begin_layout Section*
Acknowledgements
\end_layout

\begin_layout Standard
I'd like to thank Chris Boulton and Hywel Williams, Jon Pitchford and Alex
 James for the encouragement and conversations that led to this paper.
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
Abstract
\end_layout

\begin_layout Plain Layout
Intro
\end_layout

\begin_layout Plain Layout
-How to perform significance testing & how number of tests to run maybe
 non trivial
\end_layout

\begin_layout Plain Layout
-Nestedness as a contentious issue
\end_layout

\begin_layout Plain Layout
- We introduce software that can perform significance testing using an adaptive
 algorithm which may speed up analysis.
\end_layout

\begin_layout Plain Layout
Methods
\end_layout

\begin_layout Plain Layout
Description of this section
\end_layout

\begin_layout Plain Layout
-- Measures
\end_layout

\begin_layout Plain Layout
NODF etc.
\end_layout

\begin_layout Plain Layout
--Null models
\end_layout

\begin_layout Plain Layout
...
\end_layout

\begin_layout Plain Layout
--Solvers
\end_layout

\begin_layout Plain Layout
-Fixed Method
\end_layout

\begin_layout Plain Layout
-Adaptive method
\end_layout

\begin_layout Plain Layout
Results
\end_layout

\begin_layout Plain Layout
- need to show that using the adaptive method is worthwhile - speed + accuracy.
\end_layout

\begin_layout Plain Layout
Discussion
\end_layout

\begin_layout Plain Layout
-What is nestedness connected to (James et al.)
\end_layout

\begin_layout Plain Layout
-How great a level of significance is it worth getting down to Ulrich etc.
 reponse
\end_layout

\begin_layout Plain Layout
-Comparing measures as a next step.
\end_layout

\begin_layout Standard
Intro- what is FALCON
\end_layout

\begin_layout Plain Layout
PROCEDURE FOR ENSEMBLE TESTING FOR SIGNIFICANCE
\end_layout

\begin_layout Plain Layout
SOLVERS
\end_layout

\begin_layout Plain Layout
-FIXED
\end_layout

\begin_layout Plain Layout
-ADAPTIVE
\end_layout

\begin_layout Plain Layout
MEASURES
\end_layout

\begin_layout Plain Layout
BINARY
\end_layout

\begin_layout Plain Layout
QUANTITATIVE
\end_layout

\begin_layout Plain Layout
BOTH
\end_layout

\begin_layout Plain Layout
NULLS
\end_layout

\begin_layout Plain Layout
EE
\end_layout

\begin_layout Plain Layout
FF
\end_layout

\begin_layout Plain Layout
RF-RF
\end_layout

\begin_layout Plain Layout
OTHER NOTES.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "FALCON"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
